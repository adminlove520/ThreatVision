<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ThreatVision - 全球威胁情报监控中心</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Marked.js & Highlight.js -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                        },
                        dark: {
                            800: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* Glassmorphism */
        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .dark .glass {
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Markdown Styles */
        .prose pre {
            background-color: #1e293b !important;
            border-radius: 0.5rem;
        }
        .prose img {
            border-radius: 0.5rem;
        }
        .prose a {
            color: #0ea5e9;
            text-decoration: none;
        }
        .prose a:hover {
            text-decoration: underline;
        }
        .prose blockquote {
            border-left-color: #0ea5e9;
            background: rgba(14, 165, 233, 0.05);
            padding: 1rem;
            border-radius: 0 0.5rem 0.5rem 0;
        }
    </style>
</head>
<body class="bg-gray-50 text-slate-800 dark:bg-dark-950 dark:text-slate-200 transition-colors duration-300">

    <!-- Mobile Overlay -->
    <div id="mobile-overlay" class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden backdrop-blur-sm transition-opacity" onclick="toggleSidebar()"></div>

    <!-- Sidebar -->
    <aside id="sidebar" class="fixed top-0 left-0 z-50 h-screen w-64 bg-white dark:bg-dark-900 border-r border-gray-200 dark:border-gray-800 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out shadow-xl lg:shadow-none">
        <div class="h-full flex flex-col">
            <!-- Logo -->
            <div class="h-16 flex items-center px-6 border-b border-gray-200 dark:border-gray-800">
                <i class="fa-solid fa-shield-halved text-primary-500 text-2xl mr-3"></i>
                <span class="text-lg font-bold tracking-tight">Threat<span class="text-primary-500">Vision</span></span>
            </div>

            <!-- Nav -->
            <nav class="flex-1 px-4 py-6 space-y-2 overflow-y-auto">
                <button onclick="switchView('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center px-4 py-3 text-sm font-medium rounded-xl transition-all duration-200 bg-primary-50 text-primary-600 dark:bg-primary-500/10 dark:text-primary-500">
                    <i class="fa-solid fa-chart-pie w-6"></i>
                    仪表盘 (Dashboard)
                </button>
                <button onclick="switchView('reports')" id="nav-reports" class="nav-item w-full flex items-center px-4 py-3 text-sm font-medium text-gray-600 dark:text-gray-400 rounded-xl hover:bg-gray-50 dark:hover:bg-dark-800 transition-all duration-200">
                    <i class="fa-solid fa-file-lines w-6"></i>
                    安全日报 (Reports)
                </button>
                <button onclick="switchView('cves')" id="nav-cves" class="nav-item w-full flex items-center px-4 py-3 text-sm font-medium text-gray-600 dark:text-gray-400 rounded-xl hover:bg-gray-50 dark:hover:bg-dark-800 transition-all duration-200">
                    <i class="fa-solid fa-bug w-6"></i>
                    漏洞库 (CVEs)
                </button>
                <button onclick="switchView('repos')" id="nav-repos" class="nav-item w-full flex items-center px-4 py-3 text-sm font-medium text-gray-600 dark:text-gray-400 rounded-xl hover:bg-gray-50 dark:hover:bg-dark-800 transition-all duration-200">
                    <i class="fa-brands fa-github w-6"></i>
                    开源监控 (Repos)
                </button>
            </nav>

            <!-- Footer -->
            <div class="p-4 border-t border-gray-200 dark:border-gray-800">
                <div class="flex items-center justify-between px-2">
                    <button onclick="toggleTheme()" class="p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:hover:bg-dark-800 transition-colors">
                        <i class="fa-solid fa-moon dark:hidden"></i>
                        <i class="fa-solid fa-sun hidden dark:block text-yellow-400"></i>
                    </button>
                    <a href="https://github.com/adminlove520/ThreatVision" target="_blank" class="p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:hover:bg-dark-800 transition-colors">
                        <i class="fa-brands fa-github text-lg"></i>
                    </a>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="lg:ml-64 min-h-screen flex flex-col">
        <!-- Header -->
        <header class="h-16 glass sticky top-0 z-30 flex items-center justify-between px-4 lg:px-8 border-b border-gray-200 dark:border-gray-800">
            <button onclick="toggleSidebar()" class="lg:hidden p-2 text-gray-600 dark:text-gray-300">
                <i class="fa-solid fa-bars text-xl"></i>
            </button>
            <div class="flex items-center space-x-4 ml-auto">
                <span class="text-xs font-mono text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-dark-800 px-2 py-1 rounded">
                    <i class="fa-solid fa-circle text-green-500 text-[8px] mr-1"></i>System Online
                </span>
            </div>
        </header>

        <!-- Content Area -->
        <div id="content-area" class="flex-1 p-4 lg:p-8 overflow-x-hidden">
            <!-- Views will be injected here -->
            
            <!-- Dashboard View -->
            <div id="view-dashboard" class="space-y-6 animate-fade-in">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <!-- Stat Card 1 -->
                    <div class="bg-white dark:bg-dark-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-800">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm font-medium text-gray-500 dark:text-gray-400">今日漏洞 (Today's CVEs)</p>
                                <h3 class="text-3xl font-bold mt-2 text-gray-900 dark:text-white" id="stat-today-cves">-</h3>
                            </div>
                            <div class="p-3 bg-red-50 dark:bg-red-900/20 rounded-xl text-red-500">
                                <i class="fa-solid fa-bug text-xl"></i>
                            </div>
                        </div>
                    </div>
                    <!-- Stat Card 2 -->
                    <div class="bg-white dark:bg-dark-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-800">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm font-medium text-gray-500 dark:text-gray-400">监控仓库 (Monitored Repos)</p>
                                <h3 class="text-3xl font-bold mt-2 text-gray-900 dark:text-white" id="stat-total-repos">-</h3>
                            </div>
                            <div class="p-3 bg-blue-50 dark:bg-blue-900/20 rounded-xl text-blue-500">
                                <i class="fa-brands fa-github text-xl"></i>
                            </div>
                        </div>
                    </div>
                    <!-- Stat Card 3 -->
                    <div class="bg-white dark:bg-dark-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-800">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm font-medium text-gray-500 dark:text-gray-400">已生成日报 (Total Reports)</p>
                                <h3 class="text-3xl font-bold mt-2 text-gray-900 dark:text-white" id="stat-total-reports">-</h3>
                            </div>
                            <div class="p-3 bg-green-50 dark:bg-green-900/20 rounded-xl text-green-500">
                                <i class="fa-solid fa-file-lines text-xl"></i>
                            </div>
                        </div>
                    </div>
                    <!-- Stat Card 4 -->
                    <div class="bg-white dark:bg-dark-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-800">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm font-medium text-gray-500 dark:text-gray-400">高危预警 (High Risk)</p>
                                <h3 class="text-3xl font-bold mt-2 text-gray-900 dark:text-white" id="stat-high-risk">-</h3>
                            </div>
                            <div class="p-3 bg-orange-50 dark:bg-orange-900/20 rounded-xl text-orange-500">
                                <i class="fa-solid fa-triangle-exclamation text-xl"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Latest Report Preview -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 bg-white dark:bg-dark-900 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-800 overflow-hidden">
                        <div class="p-6 border-b border-gray-100 dark:border-gray-800 flex justify-between items-center">
                            <h3 class="font-bold text-lg">最新安全日报 (Latest Report)</h3>
                            <button onclick="switchView('reports')" class="text-sm text-primary-500 hover:text-primary-600 font-medium">查看全部 <i class="fa-solid fa-arrow-right ml-1"></i></button>
                        </div>
                        <div id="dashboard-report-preview" class="p-6 prose dark:prose-invert max-w-none text-sm h-[400px] overflow-y-auto custom-scrollbar">
                            <!-- Content loaded via JS -->
                            <div class="flex items-center justify-center h-full text-gray-400">
                                <i class="fa-solid fa-circle-notch fa-spin mr-2"></i> Loading...
                            </div>
                        </div>
                    </div>

                    <!-- Recent CVEs List -->
                    <div class="bg-white dark:bg-dark-900 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-800 overflow-hidden">
                        <div class="p-6 border-b border-gray-100 dark:border-gray-800">
                            <h3 class="font-bold text-lg">最新漏洞 (Recent CVEs)</h3>
                        </div>
                        <div id="dashboard-cve-list" class="divide-y divide-gray-100 dark:divide-gray-800">
                            <!-- Content loaded via JS -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports View -->
            <div id="view-reports" class="hidden space-y-6 animate-fade-in">
                <div class="flex flex-col md:flex-row gap-6 h-[calc(100vh-8rem)]">
                    <!-- Report List -->
                    <div class="w-full md:w-80 bg-white dark:bg-dark-900 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-800 flex flex-col">
                        <div class="p-4 border-b border-gray-100 dark:border-gray-800">
                            <h3 class="font-bold">历史日报</h3>
                        </div>
                        <div id="report-list" class="flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar">
                            <!-- List items -->
                        </div>
                    </div>
                    <!-- Report Content -->
                    <div class="flex-1 bg-white dark:bg-dark-900 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-800 flex flex-col overflow-hidden">
                        <div id="report-viewer" class="flex-1 overflow-y-auto p-8 custom-scrollbar">
                            <article class="prose dark:prose-invert max-w-4xl mx-auto">
                                <div class="flex items-center justify-center h-full text-gray-400">
                                    <p>请选择左侧日报查看详情</p>
                                </div>
                            </article>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CVEs View -->
            <div id="view-cves" class="hidden space-y-6 animate-fade-in">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold">漏洞库 (Vulnerability Database)</h2>
                    <div class="flex gap-2">
                        <input type="text" id="cve-search" placeholder="Search CVE ID..." class="bg-white dark:bg-dark-800 border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
                    </div>
                </div>
                <div id="cve-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- CVE Cards -->
                </div>
            </div>

            <!-- Repos View -->
            <div id="view-repos" class="hidden space-y-6 animate-fade-in">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold">开源监控 (Repository Monitor)</h2>
                </div>
                <div id="repo-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Repo Cards -->
                </div>
            </div>

        </div>
    </main>

    <!-- Modal -->
    <div id="modal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeModal()"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-2xl p-4">
            <div class="bg-white dark:bg-dark-900 rounded-2xl shadow-2xl overflow-hidden max-h-[80vh] flex flex-col">
                <div class="p-6 border-b border-gray-100 dark:border-gray-800 flex justify-between items-center">
                    <h3 id="modal-title" class="text-xl font-bold">Title</h3>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                        <i class="fa-solid fa-xmark text-xl"></i>
                    </button>
                </div>
                <div id="modal-content" class="p-6 overflow-y-auto custom-scrollbar prose dark:prose-invert max-w-none">
                    <!-- Content -->
                </div>
            </div>
        </div>
    </div>

    <script src="static/app.js"></script>
</body>
</html>